{% extends "base.html" %}

{% block title %}{{ title }}{% endblock title %}

{% block content %}
<section class="space-y-4">
    <a href="/workflow/{{ workflow.id }}" class="text-xs uppercase tracking-[0.4em] text-zinc-500 transition hover:text-zinc-300">&larr; Back to workflow detail</a>
    <div class="space-y-2">
        <h1 class="text-3xl font-semibold tracking-tight text-white">Run {{ instance.id }}</h1>
        <p class="text-sm text-zinc-400">{{ workflow.name }}</p>
    </div>
    <dl class="grid gap-4 rounded-2xl border border-zinc-900 bg-zinc-900/40 p-6 md:grid-cols-2 lg:grid-cols-4">
        <div>
            <dt class="text-xs uppercase tracking-[0.4em] text-zinc-500">Version ID</dt>
            <dd class="text-lg font-semibold text-white">{{ workflow.id }}</dd>
        </div>
        <div>
            <dt class="text-xs uppercase tracking-[0.4em] text-zinc-500">Run Created</dt>
            <dd class="text-lg font-semibold text-white">{{ instance.created_at }}</dd>
        </div>
        <div>
            <dt class="text-xs uppercase tracking-[0.4em] text-zinc-500">Status</dt>
            <dd class="text-lg font-semibold text-white">{{ instance.status }}</dd>
        </div>
        <div>
            <dt class="text-xs uppercase tracking-[0.4em] text-zinc-500">Progress</dt>
            <dd class="text-lg font-semibold text-white">{{ instance.progress }}</dd>
        </div>
    </dl>
</section>

<section class="grid gap-6 lg:grid-cols-2">
    <div class="rounded-2xl border border-zinc-900 bg-zinc-900/40 p-5">
        <p class="text-xs uppercase tracking-[0.4em] text-zinc-500">Input Payload</p>
        <pre class="mt-3 overflow-x-auto whitespace-pre-wrap rounded-xl bg-zinc-950/70 p-4 text-xs text-zinc-200">{{ instance.input_payload }}</pre>
    </div>
    <div class="rounded-2xl border border-zinc-900 bg-zinc-900/40 p-5">
        <p class="text-xs uppercase tracking-[0.4em] text-zinc-500">Result Payload</p>
        <pre class="mt-3 overflow-x-auto whitespace-pre-wrap rounded-xl bg-zinc-950/70 p-4 text-xs text-zinc-200">{{ instance.result_payload }}</pre>
    </div>
</section>

<section class="space-y-3">
    <div>
        <p class="text-xs uppercase tracking-[0.4em] text-zinc-500">Nodes</p>
        <h2 class="text-2xl font-semibold text-white">Execution Details</h2>
    </div>
    <div class="grid gap-4">
        {% for node in nodes %}
            <div class="rounded-2xl border border-zinc-900 bg-zinc-900/40 p-5">
                <div class="flex flex-wrap items-center justify-between gap-2">
                    <div>
                        <p class="text-lg font-semibold text-white">{{ node.id }}</p>
                        <p class="text-sm text-zinc-300">{{ node.action }} <span class="text-zinc-500">({{ node.module }})</span></p>
                    </div>
                    <span class="rounded-full bg-zinc-800 px-3 py-1 text-xs font-semibold uppercase tracking-wide text-zinc-200">{{ node.status }}</span>
                </div>
                <div class="mt-4 grid gap-4 lg:grid-cols-2">
                    <div>
                        <p class="text-xs uppercase tracking-[0.4em] text-zinc-500">Request</p>
                        <pre class="mt-2 overflow-x-auto whitespace-pre-wrap rounded-xl bg-zinc-950/70 p-3 text-xs text-zinc-200">{{ node.request_payload }}</pre>
                    </div>
                    <div>
                        <p class="text-xs uppercase tracking-[0.4em] text-zinc-500">Response</p>
                        <pre class="mt-2 overflow-x-auto whitespace-pre-wrap rounded-xl bg-zinc-950/70 p-3 text-xs text-zinc-200">{{ node.response_payload }}</pre>
                    </div>
                </div>
            </div>
        {% endfor %}
    </div>
</section>
{% endblock content %}
